# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏ –≤ Streamlit –∫–æ–ª–±—ç–∫–∞—Ö

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í –∏—Å—Ö–æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ `create_simple_event_selector()` –±—ã–ª–∞ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏ –≤ —Ü–∏–∫–ª–∞—Ö. –ö–æ–≥–¥–∞ –∫–æ–ª–±—ç–∫-—Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å –≤–Ω—É—Ç—Ä–∏ —Ü–∏–∫–ª–æ–≤ `for`, –æ–Ω–∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–ª–∏ —Å—Å—ã–ª–∫—É –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∏–∑ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Ü–∏–∫–ª–∞, –∞ –Ω–µ –µ—ë –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏.

### üî¥ –ü—Ä–æ–±–ª–µ–º–Ω—ã–π –∫–æ–¥

```python
for event in filtered_events:
    def toggle_event_selection():
        event_name = event  # ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –ó–∞–º—ã–∫–∞–Ω–∏–µ —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Ü–∏–∫–ª–∞
        # ... –ª–æ–≥–∏–∫–∞ ...
    
    st.checkbox(..., on_change=toggle_event_selection)
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ:**
1. –í—Å–µ –∫–æ–ª–±—ç–∫–∏ —Å—Å—ã–ª–∞–ª–∏—Å—å –Ω–∞ –æ–¥–Ω—É –∏ —Ç—É –∂–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `event`
2. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ü–∏–∫–ª–∞ `event` —Å–æ–¥–µ—Ä–∂–∞–ª–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ `filtered_events`
3. –ö–ª–∏–∫ –Ω–∞ –ª—é–±–æ–π —á–µ–∫–±–æ–∫—Å –≤—ã–∑—ã–≤–∞–ª –¥–µ–π—Å—Ç–≤–∏–µ –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–±—ã—Ç–∏—è –≤ —Å–ø–∏—Å–∫–µ

### ‚ö†Ô∏è –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ –∫–æ–¥–µ

–¢–∞ –∂–µ –ø—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –∏ —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–æ—Ä–æ–Ω–∫–æ–π:
- `move_up()` –∏ `move_down()` –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `i`
- `remove_step()` —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å

## ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### 1. –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–ª–±—ç–∫–∏ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏

```python
def create_simple_event_selector():
    # --- –ö–æ–ª–±—ç–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –í–ù–ï —Ü–∏–∫–ª–æ–≤ ---
    
    def toggle_event_in_funnel(event_name: str):
        """–ü–æ–ª—É—á–∞–µ—Ç event_name –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä - –ù–ï –∏–∑ –∑–∞–º—ã–∫–∞–Ω–∏—è"""
        if event_name in st.session_state.funnel_steps:
            st.session_state.funnel_steps.remove(event_name)
        else:
            st.session_state.funnel_steps.append(event_name)
        st.session_state.analysis_results = None

    def move_step(index: int, direction: int):
        """–ü–æ–ª—É—á–∞–µ—Ç –∏–Ω–¥–µ–∫—Å –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã"""
        if 0 <= index + direction < len(st.session_state.funnel_steps):
            st.session_state.funnel_steps[index], st.session_state.funnel_steps[index + direction] = \
                st.session_state.funnel_steps[index + direction], st.session_state.funnel_steps[index]
            st.session_state.analysis_results = None

    # --- –í —Ü–∏–∫–ª–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–µ–º args ---
    
    for event in filtered_events:
        st.checkbox(
            event,
            value=is_selected,
            key=f"cb_{hash(event)}",
            on_change=toggle_event_in_funnel,
            args=(event,)  # ‚úÖ –ü–µ—Ä–µ–¥–∞—ë–º event –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç
        )
    
         for i, step in enumerate(st.session_state.funnel_steps):
         # –ö–Ω–æ–ø–∫–∏ "–≤–≤–µ—Ä—Ö/–≤–Ω–∏–∑" —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–µ–π –∏–Ω–¥–µ–∫—Å–∞
         r2.button("‚¨ÜÔ∏è", key=f"up_{i}", on_click=move_step, args=(i, -1))
         r3.button("‚¨áÔ∏è", key=f"down_{i}", on_click=move_step, args=(i, 1))
```

### 2. –ö–ª—é—á–µ–≤—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

#### üéØ –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã
```python
# –í—Å—è –ª–æ–≥–∏–∫–∞ —á–∏—Ç–∞–µ—Ç –∏ –∏–∑–º–µ–Ω—è–µ—Ç st.session_state
st.session_state.funnel_steps  # –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ—Ä–æ–Ω–∫–∏
st.session_state.analysis_results = None  # –°–±—Ä–æ—Å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
```

#### üîÑ –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π UI
```python
# UI - —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
is_selected = event in st.session_state.funnel_steps
# –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –∫–æ–ª–±—ç–∫–µ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π rerun ‚Üí –Ω–æ–≤—ã–π UI
```

#### üéõÔ∏è –ö–æ—Ä–æ—Ç–∫–∏–µ –∫–æ–ª–±—ç–∫–∏
```python
def toggle_event_in_funnel(event_name: str):
    """–î–µ–ª–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ - –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ"""
    # –ò–∑–º–µ–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    # Streamlit –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ä–∏—Å—É–µ—Ç UI
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏

```python
col_events, col_funnel = st.columns(2)

with col_events:
    # –®–∞–≥ 1: –í—ã–±–æ—Ä —Å–æ–±—ã—Ç–∏–π
    
with col_funnel:
    # –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–æ—Ä–æ–Ω–∫–∏
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ò–∑–±–µ–≥–∞–µ–º –≥–ª—É–±–æ–∫–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ `st.columns`
- –õ–æ–≥–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π
- –õ—É—á—à–∏–π UX –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 2. –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

```python
with st.container(height=400):
    for event in filtered_events:
        # –°–æ–±—ã—Ç–∏—è –≤ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è –¥–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏
- –°—Ç–∞–±–∏–ª—å–Ω—ã–π layout –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–±—ã—Ç–∏–π

### 3. –ö–æ–º–ø–∞–∫—Ç–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ—Ä–æ–Ω–∫–æ–π

```python
r1, r2, r3, r4 = st.columns([0.6, 0.1, 0.1, 0.2])
r1.markdown(f"**{i+1}.** {step}")
r2.button("‚¨ÜÔ∏è", key=f"up_{i}", on_click=move_step, args=(i, -1))
r3.button("‚¨áÔ∏è", key=f"down_{i}", on_click=move_step, args=(i, 1))
r4.button("üóëÔ∏è", key=f"del_{i}", on_click=remove_step, args=(i,))
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
```bash
python -c "import app; print('‚úÖ Syntax check passed')"
```

### Smoke —Ç–µ—Å—Ç—ã
```bash
python run_tests.py --smoke
# ‚úÖ 1 passed, 6 warnings in 3.51s
```

## üìö Takeaways –¥–ª—è –±—É–¥—É—â–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç–æ–∫

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–ö–æ–ª–±—ç–∫–∏ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `args` –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–ª–±—ç–∫–∏
2. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:** –û–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ –∫–æ–ª–±—ç–∫–∏ –≤–Ω–µ —Ü–∏–∫–ª–æ–≤
3. **–ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã:** –í—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ `st.session_state`
4. **–ö–æ—Ä–æ—Ç–∫–∏–µ –∫–æ–ª–±—ç–∫–∏:** –¢–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –±–µ–∑ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏
5. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:** `on_change` –¥–ª—è –≤–∏–¥–∂–µ—Ç–æ–≤ –≤–≤–æ–¥–∞, `on_click` –¥–ª—è –∫–Ω–æ–ø–æ–∫

### ‚ùå –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω—ã

1. **–ó–∞–º—ã–∫–∞–Ω–∏—è –≤ —Ü–∏–∫–ª–∞—Ö:** –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ —Ü–∏–∫–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª–∞
2. **–ì–ª—É–±–æ–∫–∞—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å –∫–æ–ª–æ–Ω–æ–∫:** –ò–∑–±–µ–≥–∞–π—Ç–µ `st.columns` –≤–Ω—É—Ç—Ä–∏ `st.columns`
3. **–°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤ –∫–æ–ª–±—ç–∫–∞—Ö:** –ö–æ–ª–±—ç–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –±—ã—Å—Ç—Ä—ã–º–∏ –∏ –ø—Ä–æ—Å—Ç—ã–º–∏

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

- **‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Å –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏ —Ä–µ—à–µ–Ω–∞:** –ö–∞–∂–¥—ã–π —á–µ–∫–±–æ–∫—Å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Å–æ–±—ã—Ç–∏–µ–º
- **‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ —á–∞—Å—Ç–∏, –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º—ã–µ –æ–±–ª–∞—Å—Ç–∏
- **‚úÖ –õ—É—á—à–∏–π UX:** –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –¥–≤—É–º—è —ç—Ç–∞–ø–∞–º–∏
- **‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –ö–æ–¥ –ª–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å
- **‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ù–µ—Ç –Ω–µ–Ω—É–∂–Ω—ã—Ö –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

–≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ –º–æ–∂–µ—Ç —Å–ª—É–∂–∏—Ç—å —à–∞–±–ª–æ–Ω–æ–º –¥–ª—è –ø–æ–¥–æ–±–Ω—ã—Ö –∑–∞–¥–∞—á. 